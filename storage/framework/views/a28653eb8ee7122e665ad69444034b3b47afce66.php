<div class="row">
    <div class="col-xl-8">
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table align-middle mb-0 table-nowrap">
                        <thead class="table-light">
                        <tr>
                            <th>Produto</th>
                            <th>Descrição</th>
                            <th>Preço</th>
                            <th>Quantidade</th>
                            <th colspan="2">Total</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>
                                <img src="<?php echo e(URL::asset('assets/images/product/img-1.png')); ?>" alt="product-img"
                                     title="product-img" class="avatar-md"/>
                            </td>
                            <td>
                                <h5 class="font-size-14 text-truncate"><a href="<?php echo e(url('ecommerce-product-detail')); ?>"
                                                                          class="text-dark">Half sleeve T-shirt</a></h5>
                                <p class="mb-0">Color : <span class="fw-medium">Maroon</span></p>
                            </td>
                            <td>
                                $ 450
                            </td>
                            <td>
                                <div class="me-3" style="width: 120px;">
                                    <input type="text" value="02" name="demo_vertical">
                                </div>
                            </td>
                            <td>
                                $ 900
                            </td>
                            <td>
                                <a href="javascript:void(0);" class="action-icon text-danger"> <i
                                        class="mdi mdi-trash-can font-size-18"></i></a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <img src="<?php echo e(URL::asset('assets/images/product/img-2.png')); ?>" alt="product-img"
                                     title="product-img" class="avatar-md"/>
                            </td>
                            <td>
                                <h5 class="font-size-14 text-truncate"><a href="<?php echo e(url('ecommerce-product-detail')); ?>"
                                                                          class="text-dark">Light blue T-shirt</a></h5>
                                <p class="mb-0">Color : <span class="fw-medium">Light blue</span></p>
                            </td>
                            <td>
                                $ 225
                            </td>
                            <td>
                                <div class="me-3" style="width: 120px;">
                                    <input type="text" value="01" name="demo_vertical">
                                </div>
                            </td>
                            <td>
                                $ 225
                            </td>
                            <td>
                                <a href="javascript:void(0);" class="action-icon text-danger"> <i
                                        class="mdi mdi-trash-can font-size-18"></i></a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <img src="<?php echo e(URL::asset('assets/images/product/img-3.png')); ?>" alt="product-img"
                                     title="product-img" class="avatar-md"/>
                            </td>
                            <td>
                                <h5 class="font-size-14 text-truncate"><a href="<?php echo e(url('ecommerce-product-detail')); ?>"
                                                                          class="text-dark">Black Color T-shirt</a></h5>
                                <p class="mb-0">Color : <span class="fw-medium">Black</span></p>
                            </td>
                            <td>
                                $ 152
                            </td>
                            <td>
                                <div class="me-3" style="width: 120px;">
                                    <input type="text" value="02" name="demo_vertical">
                                </div>
                            </td>
                            <td>
                                $ 304
                            </td>
                            <td>
                                <a href="javascript:void(0);" class="action-icon text-danger"> <i
                                        class="mdi mdi-trash-can font-size-18"></i></a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <img src="<?php echo e(URL::asset('assets/images/product/img-4.png')); ?>" alt="product-img"
                                     title="product-img" class="avatar-md"/>
                            </td>
                            <td>
                                <h5 class="font-size-14 text-truncate"><a href="<?php echo e(url('ecommerce-product-detail')); ?>"
                                                                          class="text-dark">Hoodie (Blue)</a></h5>
                                <p class="mb-0">Color : <span class="fw-medium">Blue</span></p>
                            </td>
                            <td>
                                $ 145
                            </td>
                            <td>
                                <div class="me-3" style="width: 120px;">
                                    <input type="text" value="02" name="demo_vertical">
                                </div>
                            </td>
                            <td>
                                $ 290
                            </td>
                            <td>
                                <a href="javascript:void(0);" class="action-icon text-danger"> <i
                                        class="mdi mdi-trash-can font-size-18"></i></a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <img src="<?php echo e(URL::asset('assets/images/product/img-5.png')); ?>" alt="product-img"
                                     title="product-img" class="avatar-md"/>
                            </td>
                            <td>
                                <h5 class="font-size-14 text-truncate"><a href="<?php echo e(url('ecommerce-product-detail')); ?>"
                                                                          class="text-dark">Half sleeve T-Shirt</a></h5>
                                <p class="mb-0">Color : <span class="fw-medium">Light orange</span></p>
                            </td>
                            <td>
                                $ 138
                            </td>
                            <td>
                                <div class="me-3" style="width: 120px;">
                                    <input type="text" value="01" name="demo_vertical">
                                </div>
                            </td>
                            <td>
                                $ 138
                            </td>
                            <td>
                                <a href="javascript:void(0);" class="action-icon text-danger"> <i
                                        class="mdi mdi-trash-can font-size-18"></i></a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <img src="<?php echo e(URL::asset('assets/images/product/img-6.png')); ?>" alt="product-img"
                                     title="product-img" class="avatar-md"/>
                            </td>
                            <td>
                                <h5 class="font-size-14 text-truncate"><a href="<?php echo e(url('ecommerce-product-detail')); ?>"
                                                                          class="text-dark">Green color T-shirt</a></h5>
                                <p class="mb-0">Color : <span class="fw-medium">Green</span></p>
                            </td>
                            <td>
                                $ 152
                            </td>
                            <td>
                                <div class="me-3" style="width: 120px;">
                                    <input type="text" value="02" name="demo_vertical">
                                </div>
                            </td>
                            <td>
                                $ 304
                            </td>
                            <td>
                                <a href="javascript:void(0);" class="action-icon text-danger"> <i
                                        class="mdi mdi-trash-can font-size-18"></i></a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="row mt-4">
                    <div class="col-sm-6">
                        <a href="<?php echo e(url('ecommerce-products')); ?>" class="btn btn-secondary">
                            <i class="mdi mdi-arrow-left me-1"></i> Continue Shopping </a>
                    </div> <!-- end col -->
                    <div class="col-sm-6">
                        <div class="text-sm-end mt-2 mt-sm-0">
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#cameraModal">
                                Checkout
                            </button>


                            <!-- The camera modal -->
                            <div class="modal fade" id="cameraModal" tabindex="-1" aria-labelledby="cameraModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="cameraModalLabel">Capture a Foto</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <video id="cameraStream" width="100%" height="auto" autoplay playsinline></video>
                                            <canvas id="imagePreview" style="display: none;"></canvas>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                                            <button type="button" class="btn btn-primary" id="btn-capture">Capturar</button>
                                            <button type="button" class="btn btn-success d-none" id="btn-send" disabled>Enviar</button>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!-- -->
                        </div>
                    </div> <!-- end col -->
                </div> <!-- end row-->
            </div>
        </div>
    </div>

</div>
<!-- end row -->
<script>
    const cameraStream = document.getElementById('cameraStream');
    const imagePreview = document.getElementById('imagePreview');
    const btnCapture = document.getElementById('btn-capture');
    const btnSend = document.getElementById('btn-send');

    // Função para iniciar a câmera
    async function initCamera() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            cameraStream.srcObject = stream;
            cameraStream.play();
        } catch (error) {
            console.error('Erro ao acessar a câmera:', error);
        }
    }

    // Evento do botão "Capturar"
    btnCapture.addEventListener('click', () => {
        const context = imagePreview.getContext('2d');
        context.drawImage(cameraStream, 0, 0, imagePreview.width, imagePreview.height);
        cameraStream.style.display = 'none';
        imagePreview.style.display = 'block';
        btnCapture.style.display = 'none';
        btnSend.style.display = 'block';
    });

    // Evento do botão "Enviar"
    btnSend.addEventListener('click', () => {
        // Converter a imagem em base64 e enviar para a rota "check"
        const imageDataURL = imagePreview.toDataURL('image/jpeg');
        sendImageToCheck(imageDataURL);

        // Fechar o modal após o envio
        const modal = new bootstrap.Modal(document.getElementById('cameraModal'));
        modal.hide();
    });

    // Função para enviar a imagem capturada para a rota "check"
    function sendImageToCheck(imageDataURL) {
        // Crie um elemento de formulário e adicione a imagem como um campo de formulário
        const form = document.createElement('form');
        form.method = 'post';
        form.action = '<?php echo e(route('check')); ?>';

        const imageInput = document.createElement('input');
        imageInput.type = 'hidden';
        imageInput.name = 'target_image';
        imageInput.value = imageDataURL;

        form.appendChild(imageInput);

        // Adicionar o formulário à página e enviá-lo
        document.body.appendChild(form);
        form.submit();
    }

    // Inicializar a câmera ao abrir o modal
    const cameraModal = document.getElementById('cameraModal');
    cameraModal.addEventListener('shown.bs.modal', initCamera);
</script>


<?php /**PATH C:\xampp\htdocs\almo_go\resources\views/cartCheckout/form.blade.php ENDPATH**/ ?>